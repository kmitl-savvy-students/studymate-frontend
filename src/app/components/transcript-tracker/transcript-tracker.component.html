<ng-container>
	<div class="mb-8">
		<h2 class="text-xl font-semibold">ข้อมูลจาก Transcript ของท่าน</h2>
		<h3 class="text-sm opacity-50">คุณ {{ currentUser?.firstname }} {{ currentUser?.lastname }}</h3>
	</div>
	<ng-container *ngIf="!transcriptData && !isFetchingTranscriptDetails">
		<div class="text-semibold rounded-3xl border bg-orange-50 p-12 text-center text-lg text-warning-400">กรุณาอัปโหลดไฟล์ Transcript เพื่อดูข้อมูลส่วนนี้</div>
	</ng-container>
	<div *ngIf="transcriptData || isFetchingTranscriptDetails">
		<div class="rounded-xl border border-main-50 p-6">
			<div *ngIf="isFetchingTranscriptDetails" class="animate-pulse">
				<div class="mb-4 h-20 w-full rounded-md bg-primary-100"></div>
				<div class="mb-4 h-20 w-full rounded-md bg-primary-100"></div>
				<div class="mb-4 h-20 w-full rounded-md bg-primary-100"></div>
				<div class="mb-4 h-20 w-full rounded-md bg-primary-100"></div>
				<div class="mb-4 h-20 w-full rounded-md bg-primary-100"></div>
			</div>
			<div *ngFor="let transcriptDetails of groupedTranscriptDetails; let i = index">
				<div *ngIf="transcriptDetails.year === 0">
					<sdm-accordion header="หน่วยกิตเทียบโอน" subHeader="Transfer Credit" accordionId="transfer-credit-acc" [accordionDefaultStatus]="true">
						<div class="flex flex-col gap-3 px-4">
							<div class="flex items-center justify-between rounded-xl border border-main-50 py-0.5 ps-5 text-lg transition-all hover:cursor-pointer hover:bg-main-10" *ngFor="let transcriptDetail of transcriptDetails.details">
								<div>
									<div class="max-w-80 truncate text-base font-semibold">{{ transcriptDetail.subject?.id }} {{ transcriptDetail.subject?.name_th }}</div>
									<div class="text-xs opacity-50">{{ transcriptDetail.subject?.name_en }}</div>
								</div>
								<div class="flex gap-3">
									<div class="flex w-[150px] items-center gap-4 p-4">
										<span class="text-xs opacity-50">หน่วยกิตที่ได้รับ</span><span class="text-lg font-semibold text-main-100">{{ transcriptDetail.subject?.credit }}</span>
									</div>
									<div class="flex w-[150px] items-center gap-4 p-4">
										<span class="text-xs opacity-50">เกรดที่ได้รับ</span><span class="text-lg font-semibold text-main-100">{{ transcriptDetail.grade }}</span>
									</div>
								</div>
							</div>
						</div>
					</sdm-accordion>
				</div>
				<div *ngIf="transcriptDetails.year !== 0">
					<sdm-accordion header="ผลการเรียน ปีการศึกษา พ.ศ. {{ transcriptDetails.year + 543 }}" subHeader="ภาคเรียนที่ {{ transcriptDetails.term }}" accordionId="transfer-credit-acc-{{ transcriptDetails.year + 543 }}-{{ transcriptDetails.term }}" [accordionDefaultStatus]="i === getFirstNonZeroYearIndex()">
						<div class="flex flex-col gap-3 px-4">
							<div class="flex items-center justify-between rounded-xl border border-main-50 py-0.5 ps-5 text-lg transition-all hover:cursor-pointer hover:bg-main-10" *ngFor="let transcriptDetail of transcriptDetails.details">
								<div>
									<div class="max-w-80 truncate text-base font-semibold">{{ transcriptDetail.subject?.id }} {{ transcriptDetail.subject?.name_th }}</div>
									<div class="text-xs opacity-50">{{ transcriptDetail.subject?.name_en }}</div>
								</div>
								<div class="flex gap-3">
									<div class="flex w-[150px] items-center gap-4 p-4">
										<span class="text-xs opacity-50">หน่วยกิตที่ได้รับ</span><span class="text-lg font-semibold text-main-100">{{ transcriptDetail.subject?.credit }}</span>
									</div>
									<div class="flex w-[150px] items-center gap-4 p-4">
										<span class="text-xs opacity-50">เกรดที่ได้รับ</span><span class="text-lg font-semibold text-main-100">{{ transcriptDetail.grade }}</span>
									</div>
								</div>
							</div>
						</div>
					</sdm-accordion>
				</div>
			</div>
		</div>
	</div>
</ng-container>
